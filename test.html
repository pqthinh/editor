<div id="toolbar-container"></div>
<div id="editor" style="border: 1px solid rgb(65, 58, 58); min-height: 300px">
  <p>This is the editor content.</p>
</div>
<script src="./build/ckeditor.js"></script>
<script>
  // customize uploader file
  function Upload(props) {
    this.loader = props.loader;
  }
  Upload.prototype = {
    upload: function () {
      if (this.loader?.file)
        return this.loader?.file.then((file) => {
          return this._initListeners(file, this.onUpload);
        });
    },
    abort: () => {},
    _initRequest: () => {},
    _initListeners: async (file, onUpload) => {
      try {
        await console.log(file);
      } catch (e) {
        console.log(e);
      }

      return new Promise((resolve) => {
        resolve({
          default: URL.createObjectURL(file),
        });
      });
    },
    _sendRequest: () => {},
  };

  BaseEditor.create(document.querySelector("#editor"))
    .then((editor) => {
      // The toolbar needs to be explicitly appended.
      document
        .querySelector("#toolbar-container")
        .appendChild(editor.ui.view.toolbar.element);

      editor.ui
        .getEditableElement()
        .parentElement.insertBefore(
          editor.ui.view.toolbar.element,
          editor.ui.getEditableElement()
        );
      editor.plugins.get("FileRepository").createUploadAdapter = (loader) => {
        return new Upload({ loader });
      };

      window.editor = editor;
    })
    .catch((error) => {
      console.error("There was a problem initializing the editor.", error);
    });
</script>
